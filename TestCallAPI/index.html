<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>志工資料查詢</title>
</head>
<body>
  <h1>志工資訊</h1>
  <p id="TestIdentify"></p>
  <div id="volunteer"></div>

  <script>
    const Liff_ID = "eygjidkknvkejifmklsjkfljsi";    //Liff回傳的ID
    const identifyapiUrl = `https://supabase-api-six.vercel.app/identify/${Liff_ID}`;   //CallAPI並帶入LIFF_ID 檢查身分別是否存在

    fetch(identifyapiUrl)
      .then(res => res.json())
      .then(result => {
        console.log(result); // ← 可觀察 API 回傳內容
        const roleText = document.getElementById("TestIdentify");
        const container = document.getElementById("volunteer");

        if (!result.role || !result.data) {    //如果「沒有 role」或「沒有 data」的話，就執行裡面的程式碼。
          window.location.href = "https://tute582.github.io/TestCallAPI/TestCallAPI/CRUD_V.html"; // ⬅️ 跳轉頁面
        }

        // 顯示角色（志工 or 長者）
        roleText.innerText = `身份：${result.role}`;    //帶入JSON中role的文字

        // 顯示志工個人資料
        const v = result.data;   // 資料存入v
        container.innerHTML = `
          <div style="border:1px solid #ccc; padding:10px; margin:5px;">
            <p><strong>姓名：</strong> ${v.volunteer_name}</p>
            <p><strong>性別：</strong> ${v.gender}</p>
            <p><strong>年齡：</strong> ${v.age}</p>
            <p><strong>專長：</strong> ${v.personality}</p>
            <p><strong>空閒時間：</strong> ${v.available_time}</p>
          </div>
        `;   //將取得的資料存入
      })
      .catch(err => {
        console.error(err);
        document.getElementById("volunteer").innerText = "❌ 無法取得志工資料。";
      });
  </script>
</body>
</html>
